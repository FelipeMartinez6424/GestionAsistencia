@model IEnumerable<Estudiante>

<h2>Lista de Estudiantes</h2>

<!-- Mensaje de error -->
@if (!string.IsNullOrEmpty(ViewBag.Mensaje))
{
    <div class="alert alert-danger" role="alert">
        @ViewBag.Mensaje
    </div>
}

<form asp-action="GuardarAsistencia" method="post">
    <input type="hidden" name="horarioId" value="@ViewBag.HorarioId" />

    <table class="table">
        <thead>
            <tr>
                <th>Nombre del Estudiante</th>
                <th>Asistió</th>
                <th>Retardo</th>
                <th>Inasistencia</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var estudiante in Model)
            {
                var asistencia = ViewBag.Asistencias != null
                ? ((List<Asistencia>)ViewBag.Asistencias).FirstOrDefault(a => a.EstudianteId == estudiante.Id)
                : null;

                var estadoActual = asistencia != null ? asistencia.Estado.ToString() : "Asistió";

                <tr>
                    <td>@estudiante.Nombre</td>
                    <td>
                        <input type="radio" name="estado_@estudiante.Id" value="Asistio" @(estadoActual == "Asistio" ? "checked" : "") />
                    </td>
                    <td>
                        <input type="radio" name="estado_@estudiante.Id" value="Retardo" @(estadoActual == "Retardo" ? "checked" : "") />
                    </td>
                    <td>
                        <input type="radio" name="estado_@estudiante.Id" value="Inasistencia" @(estadoActual == "Inasistencia" ? "checked" : "") />
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="buttons-container">
        <a href="@Url.Action("CursosDelDia", "Profesor")" class="btn btn-danger">Cancelar</a>
        <button type="submit" class="btn btn-success">Guardar Asistencia</button>
    </div>

</form>
